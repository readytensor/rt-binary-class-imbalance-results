# Binary Class Imbalance Study

This repository contains the results of a study on the impact of various imbalance handling techniques on binary classification performance on imbalanced datasets.

## Project Description

This project analyzes model performance on imbalanced datasets, specifically investigating the impact of different techniques used to address class imbalance. These techniques include the Synthetic Minority Over-sampling Technique (SMOTE), optimizing decision thresholds, and enforcing class weights. Given the challenges of imbalanced datasets in machine learning, especially in classification tasks where the distribution of classes is skewed, effective techniques like these are often considered to balance the scales and potentially improve model performance.

### Objective

The primary goal is to compare and evaluate how different models perform on binary classification imbalanced datasets when various imbalance handling techniques are applied versus when they are not.

### Methods

Various models were trained on several imbalanced datasets, both with and without applying the following techniques:

- SMOTE: To balance the class distribution by oversampling the minority class.
- Optimizing Decision Threshold: Adjusting the decision threshold to improve performance metrics such as precision and recall.
- Enforcing Class Weights: Assigning different weights to classes to handle imbalance during model training.

Performance metrics such as accuracy, precision, recall, F1-score, and AUC were captured and analyzed for each scenario.

---

## Project Structure

The following is the directory structure of the project:

- **`data/`**: This directory contains files for the datasets used in the project. Three files are included:
  - **`datasets.zip`**: This file contains all the datasets used for this analysis.
  - **`predictions.zip`**: This file contains the results of running multiple benchmarks on the datasets using different imabalance handling methods.
  - **`license`**: This file contains the license for the data.
- **`results/`**: This directory contains the result of running the **`run_all.py`** script.
  - **`charts/`**: This directory contains charts generated by the project code.
  - **`logs/`**: This directory contains logs from the metrics calculation code.
  - **`metrics/`**: This directory contains calculated metrics.
  - **`statistical_tests/`**: This directory contains the files for the repeated measures and paired-t tests for different metrics.
- **`src/`**: This directory contains the source code for this project.
  - **`f1_calculate_metrics.py`**: This file contains code for processing the data inside the **`data/predictions.zip`** file.
  - **`f2_summarize_metrics.py`**: This file contains code for summarizing the metrics into tables.
  - **`f3_create_table_svgs.py.py`**: This file contains code converting the tables into svgs.
  - **`f4_create_charts.py`**: This file contains code for creating the charts.
  - **`f5_run_statistical_tests.py`**: This file contains code running the ANOVA and paired-t tests.
  - **`logging_config.py`**: This file contains logging configurations.
  - **`metrics.py`**: This file contains helper methods for metric calculation.
  - **`run_all.py`**: This file contains code for running the entire pipeline (metrics calculation, metrics summary, create charts, etc).
  - **`utils.py`**: This file contains helper methods used throughout the project.
- **`.gitignore`**: This file specifies the files and folders that should be ignored by Git.
- **`license`**: This file contains the license for the project code.
- **`README.md`**: This file (this particular document) contains the documentation for the project.
- **`requirements.txt`**: This file contains the requirements for running the project.

## Classifiers used for analysis:

1. [rt_bin_class_adaboost_sklearn](https://github.com/readytensor/rt_bin_class_adaboost_sklearn)
2. [rt_bin_class_bagging_sklearn](https://github.com/readytensor/rt_bin_class_bagging_sklearn)
3. [rt_bin_class_catboost](https://github.com/readytensor/rt_bin_class_catboost)
4. [rt_bin_class_decision_tree_sklearn](https://github.com/readytensor/rt_bin_class_decision_tree_sklearn)
5. [rt_bin_class_ebm_interpretml](https://github.com/readytensor/rt_bin_class_ebm_interpretml)
6. [rt_bin_class_extra_trees_sklearn](https://github.com/readytensor/rt_bin_class_extra_trees_sklearn)
7. [rt_bin_class_figs_piml](https://github.com/readytensor/rt_bin_class_figs_piml)
8. [rt_bin_class_gradient_boosting_sklearn](https://github.com/readytensor/rt_bin_class_gradient_boosting_sklearn)
9. [rt_bin_class_lightgbm](https://github.com/readytensor/rt_bin_class_lightgbm)
10. [rt_bin_class_ReluDNNClassifier_piml](https://github.com/readytensor/rt_bin_class_ReluDNNClassifier_piml)
11. [rt_bin_class_logistic_regression_sklearn](https://github.com/readytensor/rt_bin_class_logistic_regression_sklearn)
12. [rt_bin_class_rf_hyperopt](https://github.com/readytensor/rt_bin_class_rf_hyperopt)
13. [rt_bin_class_simple_ann_pt_cpu](https://github.com/readytensor/rt_bin_class_simple_ann_pt_cpu)
14. [rt_bin_class_svc_sklearn](https://github.com/readytensor/rt_bin_class_svc_sklearn)
15. [rt_bin_class_xgboost](https://github.com/readytensor/rt_bin_class_xgboost)


## Usage

1. Create a virtual environment and install the dependencies listed in **`requirements.txt`**
```python
pip install -r requirements.txt
```
2. Run the **`run_all.py`** script.
3. The results will be stored in **`/results`** directory:
  - **`/results/charts`**: contains the generated charts.
  - **`/results/metrics`**: contains all metrics calculation results.
  - **`/results/statistical_tests`**: contains the results of ANOVA and pairwise t-tests.



## LICENSE

The code in this repository is licensed under the MIT License. See [license](license) for details. <br>
The data in this repository is dedicated to the public domain under CC0 1.0 Universal. See [data/license](./data/license) for details.

## Contact Information

Repository created by Ready Tensor, Inc. Visit https://www.readytensor.ai/
